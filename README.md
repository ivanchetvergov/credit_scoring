# ‚ö°Ô∏è –ö—Ä–µ–¥–∏—Ç–Ω—ã–π –¥–µ—Ñ–æ–ª—Ç: High-Performance ML-–ø–∞–π–ø–ª–∞–π–Ω

–ü—Ä–æ–µ–∫—Ç –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è —Ä–∏—Å–∫–∞ –¥–µ—Ñ–æ–ª—Ç–∞ –ø–æ –∫—Ä–µ–¥–∏—Ç—É –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω—ã—Ö Home Credit. –≠—Ç–æ—Ç –ø–∞–π–ø–ª–∞–π–Ω —Å–æ–∑–¥–∞–Ω —Å —Ñ–æ–∫—É—Å–æ–º –Ω–∞ **–≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç—å, –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å** –∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ ROC-AUC –Ω–∞ —Å–∏–ª—å–Ω–æ **–Ω–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö**.

---

## 1. üéØ –û–ø–∏—Å–∞–Ω–∏–µ –∏ –∫–ª—é—á–µ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç —Ä–µ–∞–ª–∏–∑—É–µ—Ç –ø–æ–ª–Ω—ã–π, MLOps-–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π ML-–ø–∞–π–ø–ª–∞–π–Ω –¥–ª—è –±–∏–Ω–∞—Ä–Ω–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏:

* **–†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π Feature Engineering:** –∞–≥—Ä–µ–≥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –∏–∑ 5+ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ —Å —Å–æ–∑–¥–∞–Ω–∏–µ–º —Å–æ—Ç–µ–Ω –∑–Ω–∞—á–∏–º—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤.  
* **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ "Trainer Pattern":** –≥–∏–±–∫–∞—è –û–û–ü-—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–ª—è –∏–Ω–∫–∞–ø—Å—É–ª—è—Ü–∏–∏ –ª–æ–≥–∏–∫–∏ –æ–±—É—á–µ–Ω–∏—è –∏ –ª–µ–≥–∫–æ–≥–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö –º–æ–¥–µ–ª–µ–π.  
* **–û–±—É—á–µ–Ω–∏–µ –∏ —Ç—é–Ω–∏–Ω–≥:** —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ **6 –º–æ–¥–µ–ª–µ–π** (–≤–∫–ª—é—á–∞—è CatBoost, XGBoost, SGD Classifier), –ø—Ä–æ—Ç—é–Ω–µ–Ω–Ω—ã—Ö –¥–ª—è –Ω–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏.  
* **–ù–∞–¥–µ–∂–Ω–∞—è –æ—Ü–µ–Ω–∫–∞:** –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è **Stratified K-Fold Cross-Validation** –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –æ–±–æ–±—â–∞—é—â–µ–π —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ (Generalization Score).

---

## 2. üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞: –ø—Ä–∏–Ω—Ü–∏–ø "Trainer Pattern"

–ö–ª—é—á–µ–≤–æ–π —ç–ª–µ–º–µ–Ω—Ç, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—â–∏–π –≥–∏–±–∫–æ—Å—Ç—å –∏ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å, ‚Äî —ç—Ç–æ **–ø–∞—Ç—Ç–µ—Ä–Ω "–¢—Ä–µ–Ω–µ—Ä"** (`BaseTrainer`).

| –ê—Å–ø–µ–∫—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
| :--- | :--- |
| **–ò–Ω–∫–∞–ø—Å—É–ª—è—Ü–∏—è** | `BaseTrainer` —É–ø—Ä–∞–≤–ª—è–µ—Ç –≤—Å–µ–º —Ü–∏–∫–ª–æ–º: –∑–∞–≥—Ä—É–∑–∫–æ–π –∫–æ–Ω—Ñ–∏–≥–æ–≤, CV, –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º, —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤. |
| **–°–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è** | –î–æ—á–µ—Ä–Ω–∏–µ –∫–ª–∞—Å—Å—ã (`CatBoostTrainer`, `XGBoostTrainer`) —Ä–µ–∞–ª–∏–∑—É—é—Ç **—Ç–æ–ª—å–∫–æ —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—É—é –ª–æ–≥–∏–∫—É** (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–µ—Ä–µ–¥–∞—á—É `eval_set` –∏–ª–∏ –Ω–∞—Ç–∏–≤–Ω—ã–µ –º–µ—Ö–∞–Ω–∏–∑–º—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤). |
| **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –∫–æ–Ω—Ñ–∏–≥** | –í—Å–µ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –≤—Å–µ—Ö **6 –º–æ–¥–µ–ª–µ–π** **–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –ø–æ–¥—Ç—è–≥–∏–≤–∞—é—Ç—Å—è** –∏–∑ —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –≤ –ø–∞–ø–∫–µ `configs/`, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è **–ø–æ–ª–Ω—É—é –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç—å**. |

---

## 3. üß† –ú–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ: –±–∏—Ç–≤–∞ –∞–Ω—Å–∞–º–±–ª–µ–π –∏ –ª–∏–Ω–µ–π–Ω–æ–π –º–æ—â–∏

–ü–∞–π–ø–ª–∞–π–Ω –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –º—É–ª—å—Ç–∏-–º–æ–¥–µ–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥, –≥–¥–µ –∫–∞–∂–¥–∞—è –º–æ–¥–µ–ª—å –ø—Ä–æ—Ç—é–Ω–µ–Ω–∞ –¥–ª—è –±–æ—Ä—å–±—ã —Å –¥–∏—Å–±–∞–ª–∞–Ω—Å–æ–º –∫–ª–∞—Å—Å–æ–≤ (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `class_weight` –∏–ª–∏ `scale_pos_weight`).

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –ú–æ–¥–µ–ª–∏ | –ö–ª—é—á–µ–≤–æ–π —Ç—é–Ω–∏–Ω–≥ –∏ —Ä–æ–ª—å |
| :--- | :--- | :--- |
| **–ë—É—Å—Ç–∏–Ω–≥–∏ (SOTA)** | `LightGBM`, `XGBoost`, `CatBoost` | **–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π ROC-AUC.** –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –Ω–∞—Ç–∏–≤–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏ (`scale_pos_weight: 20`), `early_stopping` –∏ —Ç–æ–Ω–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ `learning_rate`. |
| **–õ–∏–Ω–µ–π–Ω—ã–µ** | `Logistic Regression`, `SGD Classifier` | **–°–∫–æ—Ä–æ—Å—Ç—å –∏ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å.** –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã –Ω–∞ `L1/L2` —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—é. –ò–¥–µ–∞–ª—å–Ω—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ Feature Selection –∏ **—Å–∞–º–æ–≥–æ –±—ã—Å—Ç—Ä–æ–≥–æ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞** –≤ production. |
| **–ê–Ω—Å–∞–º–±–ª—å** | `Random Forest` | **–ù–∞–¥–µ–∂–Ω—ã–π –±—ç–π–∑–ª–∞–π–Ω.** –¢—é–Ω–∏–Ω–≥ `max_depth` –∏ `n_estimators` –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è —Å –±—É—Å—Ç–∏–Ω–≥–∞–º–∏. |

---

## 4. üõ†Ô∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### 4.1. –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

–î–ª—è –∑–∞–ø—É—Å–∫–∞ —Ç—Ä–µ–±—É–µ—Ç—Å—è **Python 3.9+** (—Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ).

```bash
# 1. —Å–æ–∑–¥–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
python -m venv venv
source venv/bin/activate  # –¥–ª—è Linux/Mac

# 2. —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
make install
# –∏–ª–∏
pip install -r requirements.txt
```

### 4.2. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö

–ü–æ–º–µ—Å—Ç–∏—Ç–µ –∏—Å—Ö–æ–¥–Ω—ã–µ CSV-—Ñ–∞–π–ª—ã (application_train.csv, bureau.csv –∏ —Ç.–¥.) –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é data/raw/.

### 4.3. –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –∑–∞–ø—É—Å–∫–∞ (The Main Script)

–û—Å–Ω–æ–≤–Ω–æ–π —Ü–∏–∫–ª –æ–±—É—á–µ–Ω–∏—è –∏ –æ—Ü–µ–Ω–∫–∏ —É–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å–∫—Ä–∏–ø—Ç–æ–º scripts/baseline_training.py.

| –°—Ü–µ–Ω–∞—Ä–∏–π              | –ö–æ–º–∞–Ω–¥–∞                                                | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                                                       |
| :-------------------- | :----------------------------------------------------- | :--------------------------------------------------------------- |
| –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª           | `make all`                                             | Full pipeline: Feature Engineering + –æ–±—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö –º–æ–¥–µ–ª–µ–π —Å CV. |
| –ü–æ–ª–Ω—ã–π –±—ç–π–∑–ª–∞–π–Ω       | `python scripts/baseline_training.py`                  | –ó–∞–ø—É—Å–∫–∞–µ—Ç –≤—Å–µ 6 –º–æ–¥–µ–ª–µ–π —Å 5-–∫—Ä–∞—Ç–Ω—ã–º CV.                          |
| –ë—ã—Å—Ç—Ä—ã–π —Ç–µ—Å—Ç          | `python scripts/baseline_training.py --no-cv`          | –ó–∞–ø—É—Å–∫–∞–µ—Ç –≤—Å–µ 6 –º–æ–¥–µ–ª–µ–π, –Ω–æ –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç CV.                       |
| –§–æ–∫—É—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç—é–Ω–∏–Ω–≥ | `python scripts/baseline_training.py catboost xgboost` | –û–±—É—á–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ —É–∫–∞–∑–∞–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π.                               |

# 5. üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ (—Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è)
```bash
.
‚îú‚îÄ‚îÄ Dockerfile
‚îú‚îÄ‚îÄ Makefile
‚îú‚îÄ‚îÄ README.md
‚îú‚îÄ‚îÄ app
‚îÇ   ‚îú‚îÄ‚îÄ main.py
‚îÇ   ‚îî‚îÄ‚îÄ schemas.py
‚îú‚îÄ‚îÄ configs
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ catboost_config.py
‚îÇ   ‚îú‚îÄ‚îÄ lightgbm_config.py
‚îÇ   ‚îú‚îÄ‚îÄ processeed_features_config.py
‚îÇ   ‚îú‚îÄ‚îÄ raw_features_config.py
‚îÇ   ‚îú‚îÄ‚îÄ sklearn_config.py
‚îÇ   ‚îî‚îÄ‚îÄ xgboost_config.py
‚îú‚îÄ‚îÄ requirements.txt
‚îú‚îÄ‚îÄ results
‚îÇ   ‚îú‚îÄ‚îÄ baseline_comparison.csv
‚îÇ   ‚îú‚îÄ‚îÄ feature_order.json
‚îÇ   ‚îú‚îÄ‚îÄ lightgbm_metrics.joblib
‚îÇ   ‚îú‚îÄ‚îÄ logistic_regression_metrics.joblib
‚îÇ   ‚îî‚îÄ‚îÄ random_forest_metrics.joblib
‚îú‚îÄ‚îÄ scripts
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ feature_selection.py
‚îÇ   ‚îú‚îÄ‚îÄ generate_features_config.py
‚îÇ   ‚îî‚îÄ‚îÄ train_model.py
‚îú‚îÄ‚îÄ src
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ config.py
‚îÇ   ‚îú‚îÄ‚îÄ features
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ custom_transformers.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ data_helpers.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ feature_engineering.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ pipelines.py
‚îÇ   ‚îú‚îÄ‚îÄ models
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ catboost_trainer.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ lightgbm_trainer.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ sklearn_trainer.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ trainer_interface.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ xgboost_trainer.py
‚îÇ   ‚îî‚îÄ‚îÄ reporting
‚îÇ       ‚îú‚îÄ‚îÄ __init__.py
‚îÇ       ‚îî‚îÄ‚îÄ compare_models.py
‚îî‚îÄ‚îÄ tests

10 directories, 37 files
```

# 6. üìä Feature Engineering (—Å–ª–æ–∂–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏)

- –ü—Ä–æ–µ–∫—Ç —Å–æ–∑–¥–∞–µ—Ç –±–æ–ª–µ–µ 400 –ø—Ä–∏–∑–Ω–∞–∫–æ–≤, –∏—Å–ø–æ–ª—å–∑—É—è –∞–≥—Ä–µ–≥–∞—Ü–∏—é –¥–∞–Ω–Ω—ã—Ö –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤.

- –ê–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏: —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ (—Å—Ä–µ–¥–Ω–µ–µ, –º–∏–Ω–∏–º—É–º, –º–∞–∫—Å–∏–º—É–º) –ø–æ Bureau, Bureau Balance –∏ Previous Application.

- –†–∞—Å—á–µ—Ç–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏: –æ—Ç–Ω–æ—à–µ–Ω–∏—è –º–µ–∂–¥—É –∫–ª—é—á–µ–≤—ã–º–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ (CREDIT_INCOME_RATIO, ANNUITY_INCOME_RATIO).

- –û–±—Ä–∞–±–æ—Ç–∫–∞ –∞–Ω–æ–º–∞–ª–∏–π: —è–≤–Ω–æ–µ –≤—ã–¥–µ–ª–µ–Ω–∏–µ –∞–Ω–æ–º–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, DAYS_EMPLOYED_ANOM).

# 7. üìù –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ, –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã –∏ –∫–∞—á–µ—Å—Ç–≤–æ
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

- –í—Å—è –∫–ª—é—á–µ–≤–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è (–∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, CV-—Å–∫–æ—Ä—ã, –º–µ—Ç—Ä–∏–∫–∏ Train/Test) –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –º–æ–¥—É–ª—å logging.

### –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤

- saved_models/ ‚Äî –ø–æ–ª–Ω—ã–π –ø–∞–π–ø–ª–∞–π–Ω (–ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä + –º–æ–¥–µ–ª—å) –¥–ª—è production.

- results/ ‚Äî –º–µ—Ç—Ä–∏–∫–∏, CV-—Å–∫–æ—Ä—ã, –∏—Ç–æ–≥–æ–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –º–æ–¥–µ–ª–µ–π.